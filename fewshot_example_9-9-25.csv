question,query,.
What is the outstanding portfolio for branch IN0010097?,"select a.branch_id,sum(principal_outstanding) as ""portfolio"",b.zone_name,b.area_name from accessdetails.__genai_portfolio_outstanding_1756049975215338_1756052875 a 
left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id 
where a.branch_id = 'IN0010097' group by 1,3,4",.
How much was disbursed at branch IN0010002 by product and date?,"select a.*,b.* from(select branch_id,product,ln_value_date as disbursement_date,sum(amount) as disbursed_amount,count(distinct loan_id) as number_of_loans_disbursed
from accessdetails.__genai_loans_disbursement_1756049896399611_1756121654
where branch_id ='IN0010002' and  ln_value_date is not null or ln_value_date <>''  and  group by 1,2,3) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
How many loans were disbursed at branch IN0010002 by product and date?,"select a.*,b.* from(select branch_id,product,ln_value_date as disbursement_date,count(distinct loan_id) as number_of_loans_disbursed
from accessdetails.__genai_loans_disbursement_1756049896399611_1756121654
where branch_id ='IN0010002' and ln_value_date is not null or ln_value_date <>'' group by 1,2,3) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
How many loans were closed at branch IN0010002 by product and date?,"select a.*,b.* from(select branch_id,product, loan_closed_date,count(distinct loan_id) as number_of_closed_loans
from accessdetails.__genai_loans_disbursement_1756049896399611_1756121654
where branch_id ='IN0010002' and loan_closed_date is not null or loan_closed_date <> '' group by 1,2,3) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
What is the total loan collection per branch?,"select a.*,b.* from(select branch_id,sum(tot_principal_coll+tot_interest_coll) as collection 
from accessdetails.__genai_recovery_details_1756049922474528_1756052912237 group by 1) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
What is the overdue amount per branch?,"select a.*,b.* from(select branch_id,sum(overdue_principal+overdue_interest) as overdue_amount from accessdetails.__genai_arrear_details_1756049949594103_1756052901040 group by 1)a
left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
What is the overdue interest per branch?,"select a.*,b.* from(select branch_id,sum(overdue_interest) as overdue_interest
from accessdetails.__genai_arrear_details_1756049949594103_1756052901040 group by 1) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
What are the min and max days in arrears per branch?,"select a.*,b.* from(select branch_id,min(days_in_arrear)min_dpd,max(days_in_arrear) as max_dpd
from accessdetails.__genai_arrear_details_1756049949594103_1756052901040 group by 1) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
What is the total PAR amount per branch?,"select a.*,b.* from(select branch_id,sum(par_amount) as total_par_amount
from accessdetails.__genai_arrear_details_1756049949594103_1756052901040 group by 1) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
How many customers joined branch IN0010002 by activation date?,"select branch_id,customer_activation_date,count(distinct member_id) as joined_member_count from accessdetails.__genai_customer_details_1756049993575638_1756052886934
where branch_id='IN0010002' and customer_activation_date is not null or customer_activation_date <>'' group by 1,2 order by 2 desc",.
How many customers dropped out branch IN0010002 by dropout date?,"select a.*,b.* from (select branch_id,dropout_date as customer_dropout_date,count(distinct member_id) as dropped_member_count 
from accessdetails.__genai_customer_details_1756049993575638_1756052886934
where branch_id='IN0010002' and record_type = 'DROPOUT' group by 1,2)a 
left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
How many loans were preclosed at each branch and what is the total preclosed amount?,"select a.*,b.* from (select branch_id,count(loan_id) as number_of_preclosed_loans,(sum(principal_preclosure::numeric)+sum(interest_preclosure::numeric)) as total_preclosed_amounts
from accessdetails.__genai_preclosure_1756049872124225_1756105475 
where lower(preclose_flag)='yes' and preclosed_date is not null or preclosed_date <>'' group by 1) a left join accessdetails.__genai_branch_master_1756049768773113_1756052942850 b on a.branch_id=b.branch_id",.
Zone-wise loan disbursement.,"SELECT
  T1.loan_id,
  T1.amount,
  T1.ln_value_date,
  T1.member_id,
  T2.zone_name
FROM
  accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS T1
  JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS T2 ON T1.branch_id = T2.branch_id
LIMIT 100;",.
Loan disbursement per state.,"SELECT sum(ld.amount) , bm.state_name FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS ld JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS bm ON ld.branch_id = bm.branch_id GROUP BY bm.state_name ORDER BY sum(ld.amount) DESC LIMIT 100",.
Show me loan disbursement by area.,"SELECT T1.loan_id, T1.member_id, T1.amount, T1.ln_value_date, T2.area_name FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS T1 INNER JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS T2 ON T1.branch_id = T2.branch_id LIMIT 100;",.
How much loan disbursed per funder?,"SELECT funder_id, SUM(amount) FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 GROUP BY funder_id ORDER BY SUM(amount) DESC LIMIT 100",.
Loan ID-wise disbursement.,"SELECT DISTINCT loan_id, amount, ln_value_date FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 ORDER BY loan_id LIMIT 100",.
Branch and zone-wise loan disbursement.,"SELECT
  T1.branch_id,
  T2.zone_name,
  T2.branch_name,
  SUM(T1.amount) AS total_disbursement
FROM
  accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS T1
  JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS T2 ON T1.branch_id = T2.branch_id
GROUP BY
  T1.branch_id,
  T2.zone_name,
  T2.branch_name
ORDER BY
  T1.branch_id
LIMIT 100;",.
How many loans have been disbursed in total?,SELECT COUNT(loan_id) FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 LIMIT 100,.
Loans disbursed for customer ID = X.,"
SELECT DISTINCT ld.loan_id, ld.amount, ld.ln_value_date FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS ld JOIN accessdetails.__genai_customer_details_1756049993575638_1756052886934 AS cd ON ld.member_id = cd.member_id WHERE cd.member_id = 'X' LIMIT 100;",.
Loan disbursement count by funder and zone.,"SELECT COUNT(ld.loan_id), f.fund_name, bm.zone_name FROM accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS ld JOIN accessdetails.__genai_fund_1756049783884745_1756052932734 AS f ON ld.funder_id = f.funder_id JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS bm ON ld.branch_id = bm.branch_id GROUP BY f.fund_name, bm.zone_name ORDER BY COUNT(ld.loan_id) DESC LIMIT 100",.
Branch and state-wise loan disbursement count.,"SELECT
  COUNT(DISTINCT t1.member_id),
  t2.state_name,
  t1.branch_id
FROM
  accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS t1
JOIN
  accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS t2
  ON t1.branch_id = t2.branch_id
GROUP BY
  t2.state_name,
  t1.branch_id
ORDER BY
  t2.state_name,
  t1.branch_id
LIMIT 100;",.
monthly distribution of disbursement amount and collection amount in karnatake in mysore branch?,"SELECT
  TO_CHAR(ld.""ln_value_date""::date, 'YYYY-MM') AS month,
  SUM(ld.amount) AS total_disbursement_amount,
  SUM(rd.tot_principal_coll + rd.tot_interest_coll) AS total_collection_amount
FROM
  accessdetails.__genai_loans_disbursement_1756049896399611_1756121654 AS ld
  JOIN accessdetails.__genai_branch_master_1756049768773113_1756052942850 AS bm ON ld.branch_id = bm.branch_id
  JOIN accessdetails.__genai_recovery_details_1756049922474528_1756052912237 AS rd ON ld.member_id = rd.member_id AND ld.branch_id = rd.branch_id
WHERE
  UPPER(bm.state_name) = UPPER('KARNATAKA')
  AND UPPER(bm.branch_name) LIKE UPPER('%%mysore%%')
GROUP BY
  month
ORDER BY
  month
LIMIT 100;",.
month wise disbursement amount and count for product GL.IGL.PRAGATI.PLUS?,"SELECT
  TO_CHAR(ln_value_date :: DATE, 'YYYY-MM') AS disbursement_month,
  SUM(amount) AS total_disbursement_amount,
  COUNT(*) AS disbursement_count
FROM
  accessdetails.__genai_loans_disbursement_1756049896399611_1756121654
WHERE
  UPPER(product) = UPPER('GL.IGL.PRAGATI.PLUS')
GROUP BY
  disbursement_month
ORDER BY
  disbursement_month
LIMIT
  100;",.
